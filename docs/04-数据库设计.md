# 草莓栽培智能灌溉系统 - 数据库设计

## 1. 设计概述

### 1.1 设计目标
- 支持用户权限管理和设备数据存储
- 高效处理时间序列数据（传感器数据）
- 保证数据完整性和查询性能
- 支持系统扩展和维护

### 1.2 数据库选型
- **PostgreSQL 14+**: 存储业务关系数据
- **TimescaleDB**: PostgreSQL扩展，专门处理时序数据
- **Redis**: 缓存层，存储会话和实时状态

## 2. 命名规范

### 2.1 表命名规范
- 使用蛇形命名法 (snake_case)
- 小写字母 + 下划线
- 使用复数名词
- 示例：`users`, `devices`, `sensor_data`, `irrigation_rules`

### 2.2 列命名规范
- 使用蛇形命名法 (snake_case)
- 主键统一命名为 `id`
- 外键格式：`[关联表名]_id`
- 时间字段：`created_at`, `updated_at`
- 示例：`user_id`, `device_id`, `created_at`

### 2.3 索引命名规范
- 格式：`idx_[表名]_[列名]`
- 示例：`idx_users_email`, `idx_sensor_data_device_time`

## 3. 业务数据表设计

### 3.1 用户表 (users)

| 列名 | 数据类型 | 约束 | 说明 |
|------|----------|------|------|
| id | BIGSERIAL | PRIMARY KEY | 用户唯一标识 |
| username | VARCHAR(50) | UNIQUE, NOT NULL | 用户名，用于登录 |
| password_hash | VARCHAR(255) | NOT NULL | BCrypt加密后的密码 |
| email | VARCHAR(100) | UNIQUE, NOT NULL | 用户邮箱 |
| role | VARCHAR(20) | NOT NULL DEFAULT 'USER' | 用户角色：USER, ADMIN |
| full_name | VARCHAR(100) | | 用户全名 |
| phone_number | VARCHAR(20) | | 手机号码 |
| created_at | TIMESTAMPTZ | NOT NULL DEFAULT NOW() | 账户创建时间 |
| updated_at | TIMESTAMPTZ | NOT NULL DEFAULT NOW() | 最后更新时间 |

**索引设计**:
```sql
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);
